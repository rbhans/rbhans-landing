<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RobHansen - Engineering & Automation</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&family=JetBrains+Mono:wght@400;500&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            /* Dark mode (Claude dark theme) */
            --bg: #1e1e1e;
            --bg-secondary: #2d2d2d;
            --fg: #f5f5f5;
            --fg-dim: #a0a0a0;
            --accent: #d97757;
            --accent-dim: #c5644a;
            --border: #3d3d3d;
            --hover: #353535;
            --category: #888;
            --warning: #ff9c3a;
            --automation-blue: #5aa3d8;
            --control-green: #6fb07f;
            --sensor-yellow: #f4c367;
        }

        /* Light mode (Claude light theme) */
        body.light-mode {
            --bg: #ffffff;
            --bg-secondary: #f7f7f7;
            --fg: #2d2d2d;
            --fg-dim: #666666;
            --accent: #d97757;
            --accent-dim: #c5644a;
            --border: #e0e0e0;
            --hover: #f0f0f0;
            --category: #777;
            --warning: #ff9c3a;
            --automation-blue: #4a93c8;
            --control-green: #5fa06f;
            --sensor-yellow: #e4b357;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--bg);
            color: var(--fg);
            line-height: 1.6;
            min-height: 100vh;
            overflow-x: hidden;
            transition: background-color 0.3s, color 0.3s;
        }

        code, .mono {
            font-family: 'JetBrains Mono', 'Courier New', monospace;
        }

        /* Grid pattern background with animation */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: 
                linear-gradient(rgba(217, 119, 87, 0.05) 1px, transparent 1px),
                linear-gradient(90deg, rgba(217, 119, 87, 0.05) 1px, transparent 1px);
            background-size: 40px 40px;
            pointer-events: none;
            z-index: 0;
            animation: gridShift 15s linear infinite;
        }

        @keyframes gridShift {
            0% {
                transform: translate(0, 0) rotate(0deg) scale(1);
            }
            50% {
                transform: translate(20px, 20px) rotate(0.5deg) scale(1.01);
            }
            100% {
                transform: translate(40px, 40px) rotate(0deg) scale(1);
            }
        }

        /* Floating orbs animation with more movement */
        .bg-orb {
            position: fixed;
            border-radius: 50%;
            background: radial-gradient(circle at 30% 30%, var(--accent), transparent);
            opacity: 0.04;
            pointer-events: none;
            z-index: 0;
            animation: float 25s infinite ease-in-out;
            filter: blur(1px);
        }

        .bg-orb:nth-child(1) {
            width: 600px;
            height: 600px;
            top: -300px;
            left: -300px;
            animation-duration: 30s;
            animation-name: float1;
        }

        .bg-orb:nth-child(2) {
            width: 400px;
            height: 400px;
            bottom: -200px;
            right: -200px;
            animation-duration: 35s;
            animation-delay: -10s;
            animation-name: float2;
        }

        .bg-orb:nth-child(3) {
            width: 500px;
            height: 500px;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            animation-duration: 40s;
            animation-delay: -20s;
            animation-name: float3;
        }

        /* Data flow particles */
        .particle {
            position: fixed;
            width: 2px;
            height: 2px;
            background: var(--accent);
            opacity: 0;
            pointer-events: none;
            z-index: 0;
            animation: particle-flow 10s linear infinite;
        }

        @keyframes particle-flow {
            0% {
                transform: translate(0, 100vh) scale(0);
                opacity: 0;
            }
            10% {
                opacity: 0.3;
                transform: translate(10vw, 90vh) scale(1);
            }
            90% {
                opacity: 0.3;
                transform: translate(90vw, 10vh) scale(1);
            }
            100% {
                transform: translate(100vw, 0) scale(0);
                opacity: 0;
            }
        }

        @keyframes float1 {
            0%, 100% {
                transform: translate(0, 0) rotate(0deg) scale(1);
            }
            25% {
                transform: translate(100px, 50px) rotate(45deg) scale(1.1);
            }
            50% {
                transform: translate(50px, 100px) rotate(90deg) scale(0.95);
            }
            75% {
                transform: translate(-50px, 50px) rotate(135deg) scale(1.05);
            }
        }

        @keyframes float2 {
            0%, 100% {
                transform: translate(0, 0) rotate(0deg) scale(1);
            }
            25% {
                transform: translate(-80px, -60px) rotate(-30deg) scale(1.05);
            }
            50% {
                transform: translate(-120px, 40px) rotate(-60deg) scale(0.9);
            }
            75% {
                transform: translate(-40px, -80px) rotate(-90deg) scale(1.1);
            }
        }

        @keyframes float3 {
            0%, 100% {
                transform: translate(-50%, -50%) rotate(0deg) scale(1);
            }
            33% {
                transform: translate(-45%, -55%) rotate(120deg) scale(1.08);
            }
            66% {
                transform: translate(-55%, -45%) rotate(240deg) scale(0.92);
            }
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 2rem;
            position: relative;
            z-index: 1;
        }

        /* Header */
        header {
            margin-bottom: 4rem;
            padding: 3rem 0 2rem;
            border-bottom: 1px solid var(--border);
            position: relative;
        }

        .logo-container {
            display: flex;
            align-items: center;
            gap: 2rem;
            margin-bottom: 1.5rem;
        }

        .logo-icon {
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }

        .logo-icon svg {
            width: 100%;
            height: 100%;
        }

        .logo-text {
            font-size: 2.5rem;
            font-weight: 600;
            letter-spacing: -0.02em;
        }

        .logo-text span {
            color: var(--accent);
        }

        .tagline {
            color: var(--fg-dim);
            font-size: 0.95rem;
            margin-left: 76px;
        }

        .tagline .mono {
            color: var(--automation-blue);
            font-size: 0.85rem;
        }

        /* Navigation */
        nav {
            display: flex;
            gap: 1px;
            margin-bottom: 3rem;
            background: var(--border);
            padding: 1px;
            border-radius: 6px;
            overflow: hidden;
        }

        .nav-item {
            flex: 1;
            color: var(--fg-dim);
            text-decoration: none;
            padding: 0.75rem 1.5rem;
            background: var(--bg);
            transition: all 0.2s;
            text-align: center;
            font-weight: 500;
            position: relative;
        }

        .nav-item:hover {
            background: var(--hover);
            color: var(--fg);
        }

        .nav-item.active {
            background: var(--bg-secondary);
            color: var(--accent);
        }

        .nav-item.active::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 2px;
            background: var(--accent);
        }

        /* Sections */
        .section {
            display: none;
        }

        .section.active {
            display: block;
        }

        .section-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 2rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid var(--border);
        }

        .section-title {
            font-size: 1.5rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .section-title .indicator {
            width: 8px;
            height: 8px;
            background: var(--accent);
            border-radius: 50%;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.3; }
        }

        /* Category filters */
        .category-filters {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
        }

        .category-btn {
            background: transparent;
            border: 1px solid var(--border);
            color: var(--fg-dim);
            padding: 0.4rem 1rem;
            font-family: inherit;
            font-size: 0.9rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
            border-radius: 4px;
        }

        .category-btn:hover {
            border-color: var(--accent);
            color: var(--accent);
        }

        .category-btn.active {
            background: var(--accent);
            color: var(--bg);
            border-color: var(--accent);
        }

        /* Grid layout */
        .items-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: 1.5rem;
            margin-top: 2rem;
        }

        /* Item cards */
        .item-card {
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            border-radius: 6px;
            padding: 1.5rem;
            text-decoration: none;
            color: var(--fg);
            transition: all 0.2s;
            position: relative;
            overflow: hidden;
        }

        .item-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 3px;
            height: 100%;
            background: var(--accent);
            transform: scaleY(0);
            transition: transform 0.2s;
        }

        .item-card:hover {
            border-color: var(--accent-dim);
            transform: translateY(-2px);
        }

        .item-card:hover::before {
            transform: scaleY(1);
        }

        .item-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 0.75rem;
        }

        .item-title {
            font-weight: 600;
            font-size: 1.1rem;
            color: var(--fg);
        }

        .item-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 0.25rem;
            margin-bottom: 0.75rem;
        }

        .item-tag {
            font-size: 0.7rem;
            color: var(--accent);
            background: rgba(217, 119, 87, 0.1);
            padding: 0.15rem 0.5rem;
            border-radius: 3px;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .item-description {
            color: var(--fg-dim);
            font-size: 0.9rem;
            line-height: 1.5;
            margin-bottom: 1rem;
        }

        .item-meta {
            display: flex;
            gap: 1rem;
            font-size: 0.8rem;
            color: var(--category);
            padding-top: 0.75rem;
            border-top: 1px solid var(--border);
        }

        .item-meta span {
            display: flex;
            align-items: center;
            gap: 0.25rem;
        }

        /* Status indicators */
        .status-indicator {
            width: 6px;
            height: 6px;
            border-radius: 50%;
            display: inline-block;
        }

        .status-online { background: var(--control-green); }
        .status-warning { background: var(--sensor-yellow); }
        .status-offline { background: var(--fg-dim); }

        /* About section stats */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin: 2rem 0;
        }

        .stat-card {
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            padding: 1.5rem;
            border-radius: 6px;
            text-align: center;
        }

        .stat-value {
            font-size: 2rem;
            font-weight: 600;
            color: var(--accent);
            font-family: 'JetBrains Mono', monospace;
        }

        .stat-label {
            font-size: 0.85rem;
            color: var(--fg-dim);
            text-transform: uppercase;
            letter-spacing: 0.05em;
            margin-top: 0.5rem;
        }

        /* Theme Toggle */
        .theme-toggle {
            position: fixed;
            bottom: 20px;
            left: 20px;
            width: 50px;
            height: 50px;
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            z-index: 1000;
            transition: all 0.3s;
            opacity: 0.8;
        }

        .theme-toggle:hover {
            opacity: 1;
            background: var(--hover);
            border-color: var(--accent);
        }

        .theme-toggle .icon {
            width: 24px;
            height: 24px;
            color: var(--fg);
        }

        /* Auth Toggle Button - matches theme toggle */
        .auth-toggle {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 50px;
            height: 50px;
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            z-index: 1000;
            transition: all 0.3s;
            opacity: 0.8;
        }

        .auth-toggle:hover {
            opacity: 1;
            background: var(--hover);
            border-color: var(--accent);
        }

        .auth-toggle.admin {
            background: var(--accent);
            border-color: var(--accent);
            opacity: 1;
        }

        .auth-toggle.admin .icon {
            color: var(--bg);
        }

        .auth-toggle .icon {
            width: 24px;
            height: 24px;
            color: var(--fg);
        }

        /* Footer */
        footer {
            text-align: center;
            padding: 3rem 2rem 2rem;
            border-top: 1px solid var(--border);
            margin-top: 4rem;
            color: var(--fg-dim);
        }

        .social-links {
            display: flex;
            justify-content: center;
            gap: 2rem;
            margin-top: 1rem;
        }

        .social-links a {
            color: var(--fg-dim);
            text-decoration: none;
            transition: color 0.2s;
        }

        .social-links a:hover {
            color: var(--accent);
        }

        /* Responsive */
        @media (max-width: 768px) {
            .container {
                padding: 1rem;
            }
            
            .logo-container {
                flex-direction: column;
                gap: 1rem;
                text-align: center;
            }
            
            .logo-text {
                font-size: 2rem;
            }
            
            .tagline {
                margin-left: 0;
                text-align: center;
                font-size: 0.85rem;
                line-height: 1.4;
            }
            
            .tagline .mono {
                display: block;
                margin-top: 0.25rem;
            }
            
            .items-grid {
                grid-template-columns: 1fr;
            }
            
            nav {
                flex-direction: column;
            }
            
            .section-header {
                flex-direction: column;
                align-items: stretch;
                gap: 1rem;
            }
            
            .category-filters {
                justify-content: flex-start;
                overflow-x: auto;
                padding-bottom: 0.5rem;
                -webkit-overflow-scrolling: touch;
            }
            
            .category-btn {
                flex-shrink: 0;
                font-size: 0.85rem;
                padding: 0.35rem 0.8rem;
            }
            
            .item-card {
                padding: 1.25rem;
            }
            
            .item-tags {
                gap: 0.2rem;
            }
            
            .item-tag {
                font-size: 0.65rem;
                padding: 0.1rem 0.4rem;
            }
            
            .item-meta {
                font-size: 0.75rem;
                gap: 0.75rem;
                flex-wrap: wrap;
            }
            
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .theme-toggle {
                width: 45px;
                height: 45px;
                bottom: 15px;
                left: 15px;
            }
            
            footer {
                padding: 2rem 1rem;
            }
            
            .social-links {
                flex-wrap: wrap;
                gap: 1rem;
                font-size: 0.9rem;
            }
            
            /* Adjust background orbs for mobile */
            .bg-orb:nth-child(1) {
                width: 300px;
                height: 300px;
                top: -150px;
                left: -150px;
            }
            
            .bg-orb:nth-child(2) {
                width: 250px;
                height: 250px;
                bottom: -125px;
                right: -125px;
            }
            
            .bg-orb:nth-child(3) {
                width: 300px;
                height: 300px;
            }
        }
        
        @media (max-width: 480px) {
            .logo-text {
                font-size: 1.75rem;
            }
            
            .category-filters {
                margin-right: -1rem;
                padding-left: 0;
                padding-right: 1rem;
            }
            
            .stats-grid {
                gap: 0.75rem;
            }
            
            .stat-card {
                padding: 1rem;
            }
            
            .stat-value {
                font-size: 1.5rem;
            }
        }

        /* Animations */
        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .item-card {
            animation: slideIn 0.3s ease-out backwards;
        }

        .item-card:nth-child(1) { animation-delay: 0.05s; }
        .item-card:nth-child(2) { animation-delay: 0.1s; }
        .item-card:nth-child(3) { animation-delay: 0.15s; }
        .item-card:nth-child(4) { animation-delay: 0.2s; }
        .item-card:nth-child(5) { animation-delay: 0.25s; }
        .item-card:nth-child(6) { animation-delay: 0.3s; }

        /* Kanban Board Styles */
        .kanban-controls {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .auth-status {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        #auth-text {
            font-size: 0.9rem;
            color: var(--fg-dim);
            font-weight: 500;
        }

        .auth-btn, .add-task-btn {
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            color: var(--fg);
            padding: 0.5rem 1rem;
            border-radius: 4px;
            cursor: pointer;
            font-family: inherit;
            font-size: 0.9rem;
            font-weight: 500;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .auth-btn:hover, .add-task-btn:hover:not(:disabled) {
            background: var(--hover);
            border-color: var(--accent);
        }

        .add-task-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .auth-btn.logged-in {
            background: var(--accent);
            color: var(--bg);
            border-color: var(--accent);
        }

        .kanban-board {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
            margin-top: 2rem;
        }

        .kanban-column {
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            border-radius: 6px;
            min-height: 400px;
            display: flex;
            flex-direction: column;
        }

        .column-header {
            padding: 1rem;
            border-bottom: 1px solid var(--border);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .column-title {
            font-size: 1rem;
            font-weight: 600;
            color: var(--fg);
            margin: 0;
        }

        .task-count {
            background: var(--accent);
            color: var(--bg);
            padding: 0.25rem 0.5rem;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: 600;
            min-width: 20px;
            text-align: center;
        }

        .column-content {
            flex: 1;
            padding: 1rem;
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
            min-height: 200px;
        }

        .column-content.drag-over {
            background: rgba(217, 119, 87, 0.1);
            border: 2px dashed var(--accent);
            border-radius: 4px;
        }

        .task-card {
            background: var(--bg);
            border: 1px solid var(--border);
            border-radius: 4px;
            padding: 1rem;
            cursor: grab;
            transition: all 0.2s;
            position: relative;
            overflow: hidden;
        }

        .task-card:hover {
            border-color: var(--accent-dim);
            transform: translateY(-1px);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .task-card.dragging {
            opacity: 0.5;
            transform: rotate(5deg);
            cursor: grabbing;
        }

        .task-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 3px;
            height: 100%;
            background: var(--accent);
        }

        .task-card.priority-low::before {
            background: var(--control-green);
        }

        .task-card.priority-medium::before {
            background: var(--sensor-yellow);
        }

        .task-card.priority-high::before {
            background: var(--warning);
        }

        .task-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 0.5rem;
        }

        .task-title {
            font-weight: 600;
            color: var(--fg);
            font-size: 0.95rem;
            margin: 0;
            flex: 1;
        }

        .task-actions {
            display: flex;
            gap: 0.25rem;
            opacity: 0;
            transition: opacity 0.2s;
        }

        .task-card:hover .task-actions {
            opacity: 1;
        }

        .task-action {
            background: none;
            border: none;
            color: var(--fg-dim);
            cursor: pointer;
            padding: 0.25rem;
            border-radius: 2px;
            transition: all 0.2s;
        }

        .task-action:hover {
            background: var(--hover);
            color: var(--accent);
        }

        .task-description {
            color: var(--fg-dim);
            font-size: 0.85rem;
            line-height: 1.4;
            margin: 0.5rem 0 0 0;
        }

        .task-priority {
            display: inline-block;
            font-size: 0.7rem;
            padding: 0.15rem 0.4rem;
            border-radius: 3px;
            text-transform: uppercase;
            font-weight: 600;
            letter-spacing: 0.05em;
            margin-top: 0.5rem;
        }

        .task-priority.low {
            background: rgba(111, 176, 127, 0.2);
            color: var(--control-green);
        }

        .task-priority.medium {
            background: rgba(244, 195, 103, 0.2);
            color: var(--sensor-yellow);
        }

        .task-priority.high {
            background: rgba(255, 156, 58, 0.2);
            color: var(--warning);
        }

        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            backdrop-filter: blur(4px);
        }

        .modal.show {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .modal-content {
            background: var(--bg);
            border: 1px solid var(--border);
            border-radius: 6px;
            width: 90%;
            max-width: 500px;
            max-height: 90vh;
            overflow-y: auto;
            animation: modalSlideIn 0.3s ease-out;
        }

        @keyframes modalSlideIn {
            from {
                opacity: 0;
                transform: translateY(-50px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1.5rem;
            border-bottom: 1px solid var(--border);
        }

        .modal-header h3 {
            margin: 0;
            color: var(--fg);
            font-size: 1.2rem;
        }

        .modal-close {
            background: none;
            border: none;
            font-size: 1.5rem;
            color: var(--fg-dim);
            cursor: pointer;
            padding: 0;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 4px;
            transition: all 0.2s;
        }

        .modal-close:hover {
            background: var(--hover);
            color: var(--fg);
        }

        .form-group {
            margin-bottom: 1rem;
            padding: 0 1.5rem;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            color: var(--fg);
            font-weight: 500;
        }

        .form-group input,
        .form-group textarea,
        .form-group select {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid var(--border);
            border-radius: 4px;
            background: var(--bg-secondary);
            color: var(--fg);
            font-family: inherit;
            font-size: 0.9rem;
            transition: border-color 0.2s;
            box-sizing: border-box;
        }

        .form-group input:focus,
        .form-group textarea:focus,
        .form-group select:focus {
            outline: none;
            border-color: var(--accent);
        }

        .form-group textarea {
            resize: vertical;
            min-height: 80px;
        }

        .form-actions {
            display: flex;
            gap: 1rem;
            padding: 1.5rem;
            border-top: 1px solid var(--border);
            justify-content: flex-end;
        }

        .form-actions button {
            padding: 0.75rem 1.5rem;
            border: 1px solid var(--border);
            border-radius: 4px;
            cursor: pointer;
            font-family: inherit;
            font-size: 0.9rem;
            font-weight: 500;
            transition: all 0.2s;
        }

        #cancel-btn, #login-cancel-btn {
            background: var(--bg-secondary);
            color: var(--fg-dim);
        }

        #cancel-btn:hover, #login-cancel-btn:hover {
            background: var(--hover);
            color: var(--fg);
        }

        #save-btn, #login-submit-btn {
            background: var(--accent);
            color: var(--bg);
            border-color: var(--accent);
        }

        #save-btn:hover, #login-submit-btn:hover {
            background: var(--accent-dim);
            border-color: var(--accent-dim);
        }

        #delete-btn {
            background: var(--warning);
            color: var(--bg);
            border-color: var(--warning);
        }

        #delete-btn:hover {
            background: #e85d4a;
            border-color: #e85d4a;
        }

        .error-message {
            color: var(--warning);
            font-size: 0.85rem;
            margin-top: 0.5rem;
            padding: 0.5rem;
            background: rgba(255, 156, 58, 0.1);
            border-radius: 4px;
        }

        /* Video Card Styles */
        .video-card {
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            border-radius: 6px;
            overflow: hidden;
            transition: all 0.2s;
            position: relative;
            display: flex;
            flex-direction: column;
        }

        .video-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 3px;
            height: 100%;
            background: var(--accent);
            transform: scaleY(0);
            transition: transform 0.2s;
        }

        .video-card:hover {
            border-color: var(--accent-dim);
            transform: translateY(-2px);
        }

        .video-card:hover::before {
            transform: scaleY(1);
        }

        .video-embed-container {
            position: relative;
            width: 100%;
            height: 200px;
            background: #000;
            overflow: hidden;
        }

        .video-thumbnail {
            width: 100%;
            height: 100%;
            object-fit: cover;
            cursor: pointer;
            transition: transform 0.3s;
        }

        .video-thumbnail:hover {
            transform: scale(1.05);
        }

        .video-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.3);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s;
        }

        .video-overlay:hover {
            background: rgba(0, 0, 0, 0.5);
        }

        .play-button {
            width: 60px;
            height: 60px;
            background: var(--accent);
            border: none;
            border-radius: 50%;
            color: white;
            font-size: 24px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
        }

        .play-button:hover {
            background: var(--accent-dim);
            transform: scale(1.1);
        }

        .play-button::before {
            content: 'â–¶';
            margin-left: 3px;
        }

        .video-duration {
            position: absolute;
            bottom: 8px;
            right: 8px;
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 2px 6px;
            border-radius: 3px;
            font-size: 0.75rem;
            font-weight: 500;
        }

        .video-player {
            width: 100%;
            height: 100%;
            border: none;
            position: absolute;
            top: 0;
            left: 0;
        }

        .video-info {
            padding: 1.5rem;
            flex: 1;
            display: flex;
            flex-direction: column;
        }

        .video-title {
            font-weight: 600;
            font-size: 1.1rem;
            color: var(--fg);
            margin: 0 0 0.5rem 0;
            line-height: 1.3;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .video-channel {
            color: var(--accent);
            font-size: 0.9rem;
            font-weight: 500;
            margin-bottom: 0.75rem;
        }

        .video-description {
            color: var(--fg-dim);
            font-size: 0.9rem;
            line-height: 1.5;
            margin-bottom: 1rem;
            display: -webkit-box;
            -webkit-line-clamp: 3;
            -webkit-box-orient: vertical;
            overflow: hidden;
            flex: 1;
        }

        .video-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 0.25rem;
            margin-bottom: 0.75rem;
        }

        .video-tag {
            font-size: 0.7rem;
            color: var(--accent);
            background: rgba(217, 119, 87, 0.1);
            padding: 0.15rem 0.5rem;
            border-radius: 3px;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .video-meta {
            display: flex;
            gap: 1rem;
            font-size: 0.8rem;
            color: var(--category);
            padding-top: 0.75rem;
            border-top: 1px solid var(--border);
            margin-top: auto;
        }

        .video-meta span {
            display: flex;
            align-items: center;
            gap: 0.25rem;
        }

        .video-loading {
            display: flex;
            align-items: center;
            justify-content: center;
            height: 200px;
            background: var(--bg-secondary);
            color: var(--fg-dim);
        }

        .video-error {
            display: flex;
            align-items: center;
            justify-content: center;
            height: 200px;
            background: var(--bg-secondary);
            color: var(--warning);
            font-size: 0.9rem;
        }

        /* Wiki styles */
        .wiki-container {
            display: flex;
            gap: 20px;
            height: calc(100vh - 200px);
            max-height: 800px;
        }

        .wiki-sidebar {
            width: 280px;
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            border-radius: 6px;
            padding: 20px;
            overflow-y: auto;
            flex-shrink: 0;
        }

        .wiki-content {
            flex: 1;
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            border-radius: 6px;
            padding: 30px;
            overflow-y: auto;
        }

        .wiki-nav-item {
            padding: 8px 12px;
            margin: 4px 0;
            cursor: pointer;
            border-radius: 6px;
            transition: background 0.2s;
            font-size: 14px;
            color: var(--fg);
        }

        .wiki-nav-item:hover {
            background: var(--hover);
        }

        .wiki-nav-item.active {
            background: var(--accent);
            color: white;
        }

        .wiki-category {
            font-weight: 600;
            color: var(--fg);
            margin: 16px 0 8px 0;
            padding: 8px 0;
            border-bottom: 1px solid var(--border);
            font-size: 13px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .wiki-category:first-child {
            margin-top: 0;
        }

        .wiki-controls {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }

        .wiki-btn {
            padding: 8px 16px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .wiki-btn.primary {
            background: var(--accent);
            color: white;
        }

        .wiki-btn.secondary {
            background: var(--bg-secondary);
            color: var(--fg);
            border: 1px solid var(--border);
        }

        .wiki-btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }

        .wiki-editor {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.8);
            z-index: 1000;
            display: none;
        }

        .wiki-editor.show {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .wiki-editor-modal {
            background: var(--bg);
            border-radius: 12px;
            width: 90vw;
            height: 85vh;
            max-width: 1200px;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            border: 1px solid var(--border);
        }

        .wiki-editor-header {
            padding: 20px;
            border-bottom: 1px solid var(--border);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .wiki-editor-content {
            flex: 1;
            display: flex;
            overflow: hidden;
        }

        .wiki-editor-form {
            width: 50%;
            padding: 20px;
            border-right: 1px solid var(--border);
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .wiki-editor-preview {
            width: 50%;
            padding: 20px;
            overflow-y: auto;
            background: var(--bg-secondary);
        }

        .wiki-form-group {
            display: flex;
            flex-direction: column;
            gap: 6px;
        }

        .wiki-form-label {
            font-weight: 600;
            color: var(--fg);
            font-size: 14px;
        }

        .wiki-form-input, .wiki-form-select, .wiki-form-textarea {
            padding: 10px;
            border: 1px solid var(--border);
            border-radius: 6px;
            background: var(--bg-secondary);
            color: var(--fg);
            font-family: inherit;
        }

        .wiki-form-textarea {
            flex: 1;
            resize: none;
            font-family: 'JetBrains Mono', monospace;
            font-size: 13px;
            line-height: 1.5;
        }

        .wiki-content h1, .wiki-content h2, .wiki-content h3 {
            color: var(--fg);
            margin: 20px 0 10px 0;
        }

        .wiki-content h1 {
            font-size: 28px;
            border-bottom: 2px solid var(--accent);
            padding-bottom: 10px;
        }

        .wiki-content h2 {
            font-size: 22px;
        }

        .wiki-content h3 {
            font-size: 18px;
        }

        .wiki-content p {
            line-height: 1.6;
            margin: 12px 0;
            color: var(--fg);
        }

        .wiki-content pre {
            background: var(--bg);
            padding: 15px;
            border-radius: 6px;
            overflow-x: auto;
            border: 1px solid var(--border);
        }

        .wiki-content code {
            background: var(--bg);
            padding: 2px 6px;
            border-radius: 4px;
            font-family: 'JetBrains Mono', monospace;
            font-size: 13px;
            color: var(--accent);
        }

        .wiki-content pre code {
            background: none;
            padding: 0;
            color: var(--fg);
        }

        .wiki-content ul, .wiki-content ol {
            margin: 12px 0;
            padding-left: 24px;
            color: var(--fg);
        }

        .wiki-content li {
            margin: 6px 0;
        }

        .wiki-content blockquote {
            border-left: 4px solid var(--accent);
            margin: 16px 0;
            padding: 12px 20px;
            background: var(--bg);
            border-radius: 0 6px 6px 0;
            color: var(--fg-dim);
        }

        .wiki-content img {
            max-width: 100%;
            height: auto;
            border-radius: 6px;
            margin: 12px 0;
        }

        .wiki-content a {
            color: var(--accent);
            text-decoration: none;
        }

        .wiki-content a:hover {
            text-decoration: underline;
        }

        .wiki-toolbar {
            display: flex;
            gap: 8px;
            margin-bottom: 10px;
            padding: 10px;
            background: var(--bg);
            border-radius: 6px;
            border: 1px solid var(--border);
            flex-wrap: wrap;
        }

        .wiki-toolbar-btn {
            padding: 6px 10px;
            border: none;
            background: var(--bg-secondary);
            color: var(--fg);
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
            transition: background 0.2s;
            border: 1px solid var(--border);
        }

        .wiki-toolbar-btn:hover {
            background: var(--hover);
        }

        @media (max-width: 768px) {
            .wiki-container {
                flex-direction: column;
                height: auto;
            }

            .wiki-sidebar {
                width: 100%;
                order: 2;
                max-height: 200px;
            }

            .wiki-content {
                order: 1;
                min-height: 400px;
            }

            .wiki-editor-modal {
                width: 95vw;
                height: 95vh;
            }

            .wiki-editor-content {
                flex-direction: column;
            }

            .wiki-editor-form, .wiki-editor-preview {
                width: 100%;
                height: 50%;
            }

            .wiki-editor-form {
                border-right: none;
                border-bottom: 1px solid var(--border);
            }
        }

        /* Responsive Kanban */
        @media (max-width: 768px) {
            .kanban-board {
                grid-template-columns: 1fr;
                gap: 1rem;
            }

            .kanban-controls {
                flex-direction: column;
                align-items: stretch;
                gap: 0.75rem;
            }

            .auth-status {
                justify-content: space-between;
            }

            .task-card {
                padding: 0.75rem;
            }

            .modal-content {
                width: 95%;
                margin: 1rem;
            }

            .form-actions {
                flex-direction: column;
            }

            .form-actions button {
                width: 100%;
            }

            .video-embed-container {
                height: 180px;
            }

            .play-button {
                width: 50px;
                height: 50px;
                font-size: 20px;
            }

            .video-info {
                padding: 1.25rem;
            }

            .video-meta {
                flex-direction: column;
                gap: 0.5rem;
            }
        }
    </style>
</head>
<body>
    <!-- Background animation orbs -->
    <div class="bg-orb"></div>
    <div class="bg-orb"></div>
    <div class="bg-orb"></div>
    
    <!-- Data flow particles -->
    <div class="particle" style="animation-delay: 0s; left: 10%;"></div>
    <div class="particle" style="animation-delay: 2s; left: 30%;"></div>
    <div class="particle" style="animation-delay: 4s; left: 50%;"></div>
    <div class="particle" style="animation-delay: 6s; left: 70%;"></div>
    <div class="particle" style="animation-delay: 8s; left: 90%;"></div>

    <div class="container">
        <header>
            <div class="logo-container">
                <div class="logo-icon">
                    <!-- New RH logo design - geometric/technical style -->
                    <svg width="50" height="50" viewBox="0 0 50 50" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <!-- Background grid dots -->
                        <circle cx="10" cy="10" r="1" fill="var(--accent)" opacity="0.3"/>
                        <circle cx="25" cy="10" r="1" fill="var(--accent)" opacity="0.3"/>
                        <circle cx="40" cy="10" r="1" fill="var(--accent)" opacity="0.3"/>
                        <circle cx="10" cy="25" r="1" fill="var(--accent)" opacity="0.3"/>
                        <circle cx="40" cy="25" r="1" fill="var(--accent)" opacity="0.3"/>
                        <circle cx="10" cy="40" r="1" fill="var(--accent)" opacity="0.3"/>
                        <circle cx="25" cy="40" r="1" fill="var(--accent)" opacity="0.3"/>
                        <circle cx="40" cy="40" r="1" fill="var(--accent)" opacity="0.3"/>
                        
                        <!-- R construction -->
                        <path d="M8 35V15M8 15H18C21 15 23 17 23 20C23 23 21 25 18 25H8M18 25L23 35" 
                              stroke="var(--accent)" stroke-width="2.5" stroke-linecap="square" fill="none"/>
                        
                        <!-- H construction -->
                        <path d="M27 15V35M42 15V35M27 25H42" 
                              stroke="var(--accent)" stroke-width="2.5" stroke-linecap="square" fill="none"/>
                        
                        <!-- Connection line -->
                        <line x1="23" y1="25" x2="27" y2="25" stroke="var(--accent)" stroke-width="1" opacity="0.5" stroke-dasharray="2 2"/>
                    </svg>
                </div>
                <h1 class="logo-text">Rob<span>Hansen</span></h1>
            </div>
            <p class="tagline">BAS Graphics & Technical Design <span class="mono">// Niagara | Metasys | UI/UX</span></p>
        </header>

        <nav>
            <a href="#" class="nav-item active" data-section="projects">Projects</a>
            <a href="#" class="nav-item" data-section="videos">Videos</a>
            <a href="#" class="nav-item" data-section="tasks">Tasks</a>
            <a href="#" class="nav-item" data-section="wiki">Wiki</a>
            <a href="#" class="nav-item" data-section="about">About</a>
        </nav>

        <!-- Projects Section -->
        <section class="section active" id="projects">
            <div class="section-header">
                <h2 class="section-title">
                    <span class="indicator"></span>
                    Projects
                </h2>
                <div class="category-filters" id="project-filters">
                    <button class="category-btn active" data-category="all">All</button>
                    <button class="category-btn" data-category="bas">BAS</button>
                    <button class="category-btn" data-category="niagara">Niagara</button>
                    <button class="category-btn" data-category="jci">JCI</button>
                    <button class="category-btn" data-category="web">Web</button>
                    <button class="category-btn" data-category="ai">AI</button>
                    <button class="category-btn" data-category="misc">Misc</button>
                </div>
            </div>

            <div class="items-grid" id="projects-grid">
                <!-- 
                ==========================================
                PROJECT TEMPLATE - Copy this block for each new project:
                ==========================================
                
                <a href="YOUR_GITHUB_URL" class="item-card" data-tags="tag1,tag2" target="_blank">
                    <div class="item-header">
                        <span class="item-title">Project Name</span>
                        <span class="status-indicator status-online"></span>
                    </div>
                    <div class="item-tags">
                        <span class="item-tag">TAG1</span>
                        <span class="item-tag">TAG2</span>
                    </div>
                    <p class="item-description">
                        Your project description here
                    </p>
                    <div class="item-meta">
                        <span>Language</span>
                        <span>License</span>
                        <span>Version</span>
                    </div>
                </a>
                
                ==========================================
                -->

                <!-- Example Projects - Replace with your actual projects -->
                <a href="https://github.com/rbhans/niagara-haystack-mcp" class="item-card" data-tags="bas,niagara,ai" target="_blank">
                    <div class="item-header">
                        <span class="item-title">Niagara Haystack MCP</span>
                        <span class="status-indicator status-online"></span>
                    </div>
                    <div class="item-tags">
                        <span class="item-tag">BAS</span>
                        <span class="item-tag">Niagara</span>
                        <span class="item-tag">AI</span>
                    </div>
                    <p class="item-description">
                        Open-source MCP server for Niagara, specifically using Haystack API
                    </p>
                    <div class="item-meta">
                        <span>Python</span>
                        <span>v1.0</span>
                    </div>
                </a>

                <a href="https://github.com/rbhans/regex-gen" class="item-card" data-tags="bas,niagara" target="_blank">
                    <div class="item-header">
                        <span class="item-title">RegEx Generator</span>
                        <span class="status-indicator status-online"></span>
                    </div>
                    <div class="item-tags">
                        <span class="item-tag">BAS</span>
                        <span class="item-tag">Niagara</span>
                    </div>
                    <p class="item-description">
                        A Progressive Web Application for generating regex patterns for Tridium Niagara Reflow point mapping.
                    </p>
                    <div class="item-meta">
                        <span>HTML</span>
                        <span>v1.0</span>
                    </div>
                </a>

                <a href="https://github.com/rbhans/pomodoro-timer" class="item-card" data-tags="misc,web" target="_blank">
                    <div class="item-header">
                        <span class="item-title">Pomodoro</span>
                        <span class="status-indicator status-online"></span>
                    </div>
                    <div class="item-tags">
                        <span class="item-tag">Misc</span>
                        <span class="item-tag">Web</span>
                    </div>
                    <p class="item-description">
                        A beautiful, feature-rich Pomodoro timer with journaling, multiple themes, and reflection time.
                    </p>
                    <div class="item-meta">
                        <span>Javascript</span>
                        <span>v1.0</span>
                    </div>
                </a>
                <a href="https://rbhans.github.io/mui-custom-symbol-builder/" class="item-card" data-tags="bas,jci" target="_blank">
                    <div class="item-header">
                        <span class="item-title">JCI MUI Custom Symbol Builder</span>
                        <span class="status-indicator status-online"></span>
                    </div>
                    <div class="item-tags">
                        <span class="item-tag">BAS</span>
                        <span class="item-tag">JCI</span>
                    </div>
                    <p class="item-description">
                        A web-based tool for creating properly formatted custom symbol packages for Johnson Controls Metasys UI.
                    </p>
                    <div class="item-meta">
                        <span>HTML</span>
                        <span>v1.0</span>
                    </div>
                </a>
            </div>
        </section>

        <!-- Videos Section -->
        <section class="section" id="videos">
            <div class="section-header">
                <h2 class="section-title">
                    <span class="indicator"></span>
                    Videos
                </h2>
                <div class="category-filters" id="video-filters">
                    <button class="category-btn active" data-category="all">All</button>
                    <button class="category-btn" data-category="tutorial">Tutorial</button>
                    <button class="category-btn" data-category="demo">Demo</button>
                    <button class="category-btn" data-category="niagara">Niagara</button>
                    <button class="category-btn" data-category="jci">JCI</button>
                    <button class="category-btn" data-category="web">Web</button>
                    <button class="category-btn" data-category="misc">Misc</button>
                </div>
            </div>

            <div class="items-grid" id="videos-grid">
                <!-- Videos will be automatically loaded from YouTube API -->
                <div class="video-loading">
                    <span>Loading videos...</span>
                </div>
            </div>
        </section>

        <!-- Tasks Section -->
        <section class="section" id="tasks">
            <div class="section-header">
                <h2 class="section-title">
                    <span class="indicator"></span>
                    Tasks
                </h2>
                <div class="kanban-controls">
                    <button id="add-task-btn" class="add-task-btn" disabled>
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/>
                        </svg>
                        Add Task
                    </button>
                </div>
            </div>

            <div class="kanban-board">
                <div class="kanban-column" data-status="todo">
                    <div class="column-header">
                        <h3 class="column-title">To Do</h3>
                        <span class="task-count" id="todo-count">0</span>
                    </div>
                    <div class="column-content" id="todo-tasks"></div>
                </div>

                <div class="kanban-column" data-status="inprogress">
                    <div class="column-header">
                        <h3 class="column-title">In Progress</h3>
                        <span class="task-count" id="inprogress-count">0</span>
                    </div>
                    <div class="column-content" id="inprogress-tasks"></div>
                </div>

                <div class="kanban-column" data-status="done">
                    <div class="column-header">
                        <h3 class="column-title">Done</h3>
                        <span class="task-count" id="done-count">0</span>
                    </div>
                    <div class="column-content" id="done-tasks"></div>
                </div>
            </div>
        </section>

        <!-- Task Modal -->
        <div id="task-modal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 id="modal-title">Add Task</h3>
                    <button class="modal-close" id="modal-close">&times;</button>
                </div>
                <form id="task-form">
                    <div class="form-group">
                        <label for="task-title">Title</label>
                        <input type="text" id="task-title" required maxlength="100">
                    </div>
                    <div class="form-group">
                        <label for="task-description">Description</label>
                        <textarea id="task-description" rows="3" maxlength="500"></textarea>
                    </div>
                    <div class="form-group">
                        <label for="task-priority">Priority</label>
                        <select id="task-priority">
                            <option value="low">Low</option>
                            <option value="medium" selected>Medium</option>
                            <option value="high">High</option>
                        </select>
                    </div>
                    <div class="form-actions">
                        <button type="button" id="cancel-btn">Cancel</button>
                        <button type="submit" id="save-btn">Save Task</button>
                        <button type="button" id="delete-btn" style="display: none;">Delete</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Login Modal -->
        <div id="login-modal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Admin Login</h3>
                    <button class="modal-close" id="login-modal-close">&times;</button>
                </div>
                <form id="login-form">
                    <div class="form-group">
                        <label for="login-email">Email</label>
                        <input type="email" id="login-email" required>
                    </div>
                    <div class="form-group">
                        <label for="login-password">Password</label>
                        <input type="password" id="login-password" required>
                    </div>
                    <div class="form-actions">
                        <button type="button" id="login-cancel-btn">Cancel</button>
                        <button type="submit" id="login-submit-btn">Login</button>
                    </div>
                    <div id="login-error" class="error-message" style="display: none;"></div>
                </form>
            </div>
        </div>

        <!-- Wiki Section -->
        <section class="section" id="wiki">
            <div class="wiki-container">
                <!-- Wiki Sidebar -->
                <div class="wiki-sidebar">
                    <div class="wiki-search">
                        <input type="text" id="wiki-search" placeholder="Search wiki..." disabled>
                    </div>

                    <div class="wiki-nav" id="wiki-nav">
                        <div class="wiki-loading">Loading pages...</div>
                    </div>

                    <div class="wiki-controls" id="wiki-controls" style="display: none;">
                        <button class="wiki-btn" id="new-page-btn">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/>
                            </svg>
                            New Page
                        </button>
                    </div>
                </div>

                <!-- Wiki Content -->
                <div class="wiki-content">
                    <div class="wiki-header">
                        <h1 class="wiki-title" id="wiki-title">Welcome to the Wiki</h1>
                        <div class="wiki-actions" id="wiki-actions" style="display: none;">
                            <button class="wiki-btn" id="edit-page-btn">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                                    <path d="M20.71,7.04C21.1,6.65 21.1,6 20.71,5.63L18.37,3.29C18,2.9 17.35,2.9 16.96,3.29L15.12,5.12L18.87,8.87M3,17.25V21H6.75L17.81,9.93L14.06,6.18L3,17.25Z"/>
                                </svg>
                                Edit
                            </button>
                        </div>
                    </div>

                    <div class="wiki-body" id="wiki-body">
                        <div class="wiki-loading">Loading content...</div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Wiki Editor Modal -->
        <div id="wiki-editor-modal" class="modal">
            <div class="modal-content wiki-editor-content">
                <div class="modal-header">
                    <h3 id="editor-title">Edit Page</h3>
                    <button class="modal-close" id="editor-close">&times;</button>
                </div>

                <div class="editor-container">
                    <div class="editor-tabs">
                        <button class="editor-tab active" data-tab="edit">Edit</button>
                        <button class="editor-tab" data-tab="preview">Preview</button>
                    </div>

                    <div class="editor-form">
                        <form id="wiki-form">
                            <div class="form-group">
                                <label for="page-title">Title</label>
                                <input type="text" id="page-title" required maxlength="100">
                            </div>

                            <div class="form-group">
                                <label for="page-slug">URL Slug</label>
                                <input type="text" id="page-slug" required maxlength="100" pattern="[a-z0-9-]+">
                                <small>Only lowercase letters, numbers, and hyphens</small>
                            </div>

                            <div class="form-group">
                                <label for="page-category">Category</label>
                                <select id="page-category">
                                    <option value="Getting Started">Getting Started</option>
                                    <option value="Niagara">Niagara</option>
                                    <option value="JCI Metasys">JCI Metasys</option>
                                    <option value="Schneider">Schneider</option>
                                    <option value="Troubleshooting">Troubleshooting</option>
                                    <option value="Best Practices">Best Practices</option>
                                </select>
                            </div>

                            <div class="editor-content">
                                <div class="editor-pane active" id="edit-pane">
                                    <div class="editor-toolbar">
                                        <button type="button" class="toolbar-btn" data-action="bold" title="Bold">
                                            <strong>B</strong>
                                        </button>
                                        <button type="button" class="toolbar-btn" data-action="italic" title="Italic">
                                            <em>I</em>
                                        </button>
                                        <button type="button" class="toolbar-btn" data-action="link" title="Link">
                                            ðŸ”—
                                        </button>
                                        <button type="button" class="toolbar-btn" data-action="code" title="Code">
                                            &lt;&gt;
                                        </button>
                                        <button type="button" class="toolbar-btn" data-action="image" title="Image">
                                            ðŸ–¼ï¸
                                        </button>
                                    </div>
                                    <textarea id="page-content" placeholder="Write your content in Markdown..." rows="20"></textarea>
                                </div>

                                <div class="editor-pane" id="preview-pane">
                                    <div class="preview-content" id="preview-content">
                                        Preview will appear here...
                                    </div>
                                </div>
                            </div>

                            <div class="form-actions">
                                <button type="button" id="editor-cancel">Cancel</button>
                                <button type="submit" id="save-page-btn">Save Page</button>
                                <button type="button" id="delete-page-btn" style="display: none;">Delete</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>

        <!-- About Section -->
        <section class="section" id="about">
            <div class="section-header">
                <h2 class="section-title">
                    <span class="indicator"></span>
                    About
                </h2>
            </div>

            <div class="stats-grid">
    <div class="stat-card">
        <div class="stat-value">12+</div>
        <div class="stat-label">Years BAS Experience</div>
    </div>
    <div class="stat-card">
        <div class="stat-value">1000+</div>
        <div class="stat-label">Graphics Created</div>
    </div>
    <div class="stat-card">
        <div class="stat-value">200+</div>
        <div class="stat-label">Sites Deployed</div>
    </div>
    <div class="stat-card">
        <div class="stat-value">ISU '11</div>
        <div class="stat-label">Mechanical Eng</div>
    </div>
</div>

<div style="max-width: 800px; margin: 3rem auto;">
    <div style="text-align: center; margin-bottom: 2rem;">
        <p style="line-height: 1.8; color: var(--fg-dim); margin-bottom: 1.5rem;">
            Lead Graphic Designer at QA Graphics with 12+ years specializing in building automation system graphics and user interfaces. 
            Creating intuitive technical visualizations that bridge complex control systems with user-friendly operation across multiple platforms.
        </p>
    </div>
    
    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 2rem; margin: 2rem 0;">
        <div>
            <h4 style="color: var(--accent); margin-bottom: 1rem; font-size: 1.1rem;">Professional Journey</h4>
            <p style="line-height: 1.6; color: var(--fg-dim); font-size: 0.9rem;">
                Started with hands-on HVAC experience in test & balance after earning my Mechanical Engineering degree from Iowa State (2011). 
                Joined QA Graphics in 2013, where I've grown into leading graphics development for major BAS platforms including JCI Metasys, 
                Tridium Niagara, and Schneider EcoStruxure.
            </p>
        </div>
        <div>
            <h4 style="color: var(--accent); margin-bottom: 1rem; font-size: 1.1rem;">Beyond Work</h4>
            <p style="line-height: 1.6; color: var(--fg-dim); font-size: 0.9rem;">
                Passionate about emerging tech and gaming innovations. When not designing interfaces, you'll find me hiking Arizona trails, 
                exploring new software tools, or spending time with my wife and son here in Tucson. Always eager to learn what's next in technology.
            </p>
        </div>
    </div>
</div>

<div style="margin-top: 3rem; padding: 2rem; background: var(--bg-secondary); border-radius: 6px; border: 1px solid var(--border);">
    <h3 style="margin-bottom: 1.5rem; color: var(--accent); text-align: center;">Technical Expertise</h3>
    <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 1.5rem; margin-bottom: 1rem;">
        <div>
            <h4 style="color: var(--fg); margin-bottom: 0.75rem; font-size: 0.95rem;">BAS Platforms</h4>
            <div style="display: flex; flex-wrap: wrap; gap: 0.5rem;">
                <span class="item-tag" style="font-size: 0.75rem; padding: 0.25rem 0.5rem;">Niagara N4</span>
                <span class="item-tag" style="font-size: 0.75rem; padding: 0.25rem 0.5rem;">JCI Metasys</span>
                <span class="item-tag" style="font-size: 0.75rem; padding: 0.25rem 0.5rem;">EcoStruxure</span>
            </div>
        </div>
        <div>
            <h4 style="color: var(--fg); margin-bottom: 0.75rem; font-size: 0.95rem;">Development</h4>
            <div style="display: flex; flex-wrap: wrap; gap: 0.5rem;">
                <span class="item-tag" style="font-size: 0.75rem; padding: 0.25rem 0.5rem;">Python</span>
                <span class="item-tag" style="font-size: 0.75rem; padding: 0.25rem 0.5rem;">JavaScript</span>
                <span class="item-tag" style="font-size: 0.75rem; padding: 0.25rem 0.5rem;">HTML5/Canvas</span>
                <span class="item-tag" style="font-size: 0.75rem; padding: 0.25rem 0.5rem;">SVG Animation</span>
            </div>
        </div>
        <div>
            <h4 style="color: var(--fg); margin-bottom: 0.75rem; font-size: 0.95rem;">Design & Systems</h4>
            <div style="display: flex; flex-wrap: wrap; gap: 0.5rem;">
                <span class="item-tag" style="font-size: 0.75rem; padding: 0.25rem 0.5rem;">UI/UX Design</span>
                <span class="item-tag" style="font-size: 0.75rem; padding: 0.25rem 0.5rem;">PX/HX Pages</span>
                <span class="item-tag" style="font-size: 0.75rem; padding: 0.25rem 0.5rem;">BACnet/Modbus</span>
            </div>
        </div>
    </div>
</div>
        </section>

        <footer>
            <p style="font-family: 'JetBrains Mono', monospace; color: var(--accent);">
                // Turning complex systems into clear interfaces
            </p>
            <div class="social-links">
                <a href="https://github.com/yourusername" target="_blank">GitHub</a>
                <a href="https://youtube.com/@yourchannel" target="_blank">YouTube</a>
                <a href="https://linkedin.com/in/yourprofile" target="_blank">LinkedIn</a>
                <a href="mailto:your@email.com">Email</a>
            </div>
        </footer>
    </div>

    <!-- Supabase SDK -->
    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>

    <!-- Markdown and Syntax Highlighting -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css">
    <script src="https://cdn.jsdelivr.net/npm/dompurify@3.0.6/dist/purify.min.js"></script>

    <!-- Theme Toggle Button -->
    <div class="theme-toggle" onclick="toggleTheme()" title="Toggle Light/Dark Mode">
        <svg class="icon" id="theme-icon" fill="currentColor" viewBox="0 0 24 24">
            <!-- Sun icon (for dark mode - click to go light) -->
            <path d="M12,7A5,5 0 0,1 17,12A5,5 0 0,1 12,17A5,5 0 0,1 7,12A5,5 0 0,1 12,7M12,9A3,3 0 0,0 9,12A3,3 0 0,0 12,15A3,3 0 0,0 15,12A3,3 0 0,0 12,9M12,2L14.39,5.42C13.65,5.15 12.84,5 12,5C11.16,5 10.35,5.15 9.61,5.42L12,2M3.34,7L7.5,6.65C6.9,7.16 6.36,7.78 5.94,8.5C5.5,9.24 5.25,10 5.11,10.79L3.34,7M3.36,17L5.12,13.23C5.26,14 5.53,14.78 5.95,15.5C6.37,16.24 6.91,16.86 7.5,17.37L3.36,17M20.65,7L18.88,10.79C18.74,10 18.47,9.23 18.05,8.5C17.63,7.78 17.1,7.15 16.5,6.64L20.65,7M20.64,17L16.5,17.36C17.09,16.85 17.62,16.22 18.04,15.5C18.46,14.77 18.73,14 18.87,13.21L20.64,17Z"/>
        </svg>
    </div>

    <!-- Global Auth Toggle Button -->
    <div class="auth-toggle" id="auth-toggle" onclick="globalAuth.handleAuthClick()" title="Admin Login">
        <svg class="icon" id="auth-icon" fill="currentColor" viewBox="0 0 24 24">
            <!-- User icon (logged out) -->
            <path d="M12,4A4,4 0 0,1 16,8A4,4 0 0,1 12,12A4,4 0 0,1 8,8A4,4 0 0,1 12,4M12,14C16.42,14 20,15.79 20,18V20H4V18C4,15.79 7.58,14 12,14Z"/>
        </svg>
    </div>

    <script>
        // Supabase Configuration
        const SUPABASE_URL = 'https://bvejujvjwpfndydlprbr.supabase.co';
        const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJ2ZWp1anZqd3BmbmR5ZGxwcmJyIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTgxNTA0NDQsImV4cCI6MjA3MzcyNjQ0NH0.6YOaFdMYVO02r6QGZAtzcCg2nagGP6BLu9ktTESykfM';

        const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

        // Global variables (legacy - will be replaced by globalAuth)
        let currentUser = null;
        let isAdmin = false;
        let tasks = [];
        let currentEditingTask = null;

        // Initialize global auth when page loads
        document.addEventListener('DOMContentLoaded', () => {
            globalAuth = new GlobalAuth();
        });

        // Initialize wiki manager
        let wikiManager = null;

        // YouTube API Configuration
        const YOUTUBE_API_KEY = 'AIzaSyDGaJ5JDQei9myw3cBrU1Qn7o4pnj4A0CQ';
        const YOUTUBE_API_BASE = 'https://www.googleapis.com/youtube/v3';

        // Video Configuration - Add your YouTube URLs here
        const videosConfig = [
            {
                url: 'https://youtu.be/fxnhaclOBB8', // Example - replace with your videos
                tags: ['demo', 'niagara'],
                customDescription: '' // Optional override
            },
            {
                url: 'https://youtu.be/W6yDs3ogMIM', // Example - replace with your videos
                tags: ['demo', 'jci'],
                customDescription: '' // Optional override
            }
            // Add more videos here
        ];

        // Video metadata cache
        let videoMetadata = new Map();

        // Global Authentication Management
        class GlobalAuth {
            constructor() {
                this.currentUser = null;
                this.isAdmin = false;
                this.authToggle = null;
                this.authIcon = null;
                this.loginModal = null;
                this.callbacks = [];

                this.init();
            }

            init() {
                this.authToggle = document.getElementById('auth-toggle');
                this.authIcon = document.getElementById('auth-icon');
                this.loginModal = document.getElementById('login-modal');

                // Setup login form
                this.setupLoginForm();

                // Check initial auth status
                this.checkAuthStatus();
            }

            setupLoginForm() {
                const loginForm = document.getElementById('login-form');
                const loginModalClose = document.getElementById('login-modal-close');
                const loginCancelBtn = document.getElementById('login-cancel-btn');

                loginForm.addEventListener('submit', (e) => this.handleLogin(e));
                loginModalClose.addEventListener('click', () => this.closeLoginModal());
                loginCancelBtn.addEventListener('click', () => this.closeLoginModal());

                // Close modal on outside click
                window.addEventListener('click', (e) => {
                    if (e.target === this.loginModal) this.closeLoginModal();
                });
            }

            async checkAuthStatus() {
                try {
                    const { data: { user } } = await supabase.auth.getUser();
                    this.currentUser = user;

                    if (user) {
                        this.isAdmin = user.email === 'rbhansen@protonmail.com';
                    } else {
                        this.isAdmin = false;
                    }

                    this.updateAuthUI();
                    this.notifyCallbacks();
                } catch (error) {
                    console.error('Auth check error:', error);
                    this.isAdmin = false;
                    this.updateAuthUI();
                    this.notifyCallbacks();
                }
            }

            updateAuthUI() {
                if (this.isAdmin) {
                    this.authToggle.classList.add('admin');
                    this.authToggle.title = 'Admin - Click to Logout';
                    // Admin icon (shield)
                    this.authIcon.innerHTML = '<path d="M12,1L3,5V11C3,16.55 6.84,21.74 12,23C17.16,21.74 21,16.55 21,11V5L12,1M12,7C13.4,7 14.8,8.6 14.8,10V11.5C15.4,11.4 16,11.9 16,12.5V16.5C16,17.1 15.6,17.5 15,17.5H9C8.4,17.5 8,17.1 8,16.5V12.5C8,11.9 8.4,11.4 9,11.5V10C9,8.6 10.6,7 12,7M12,8.2C11.2,8.2 10.2,9.2 10.2,10V11.5H13.8V10C13.8,9.2 12.8,8.2 12,8.2Z"/>';
                } else {
                    this.authToggle.classList.remove('admin');
                    this.authToggle.title = 'Admin Login';
                    // User icon (logged out)
                    this.authIcon.innerHTML = '<path d="M12,4A4,4 0 0,1 16,8A4,4 0 0,1 12,12A4,4 0 0,1 8,8A4,4 0 0,1 12,4M12,14C16.42,14 20,15.79 20,18V20H4V18C4,15.79 7.58,14 12,14Z"/>';
                }
            }

            async handleAuthClick() {
                if (this.currentUser && this.isAdmin) {
                    // Logout
                    await supabase.auth.signOut();
                    this.currentUser = null;
                    this.isAdmin = false;
                    this.updateAuthUI();
                    this.notifyCallbacks();
                } else {
                    // Show login modal
                    this.openLoginModal();
                }
            }

            openLoginModal() {
                this.loginModal.classList.add('show');
                document.getElementById('login-email').focus();
            }

            closeLoginModal() {
                this.loginModal.classList.remove('show');
                document.getElementById('login-form').reset();
                document.getElementById('login-error').style.display = 'none';
            }

            async handleLogin(e) {
                e.preventDefault();
                const email = document.getElementById('login-email').value;
                const password = document.getElementById('login-password').value;
                const errorDiv = document.getElementById('login-error');

                try {
                    const { data, error } = await supabase.auth.signInWithPassword({
                        email,
                        password
                    });

                    if (error) throw error;

                    // Check if user is admin
                    if (data.user.email !== 'rbhansen@protonmail.com') {
                        await supabase.auth.signOut();
                        throw new Error('Access denied. Admin privileges required.');
                    }

                    this.currentUser = data.user;
                    this.isAdmin = true;
                    this.updateAuthUI();
                    this.closeLoginModal();
                    this.notifyCallbacks();

                } catch (error) {
                    errorDiv.textContent = error.message;
                    errorDiv.style.display = 'block';
                }
            }

            // Callback system for other components to listen to auth changes
            onAuthChange(callback) {
                this.callbacks.push(callback);
            }

            notifyCallbacks() {
                this.callbacks.forEach(callback => {
                    try {
                        callback(this.isAdmin, this.currentUser);
                    } catch (error) {
                        console.error('Auth callback error:', error);
                    }
                });
            }

            // Getters for other components
            get admin() {
                return this.isAdmin;
            }

            get user() {
                return this.currentUser;
            }
        }

        // Initialize global auth
        let globalAuth = null;

        // Wiki Manager Class
        class WikiManager {
            constructor() {
                this.currentPage = null;
                this.pages = [];
                this.categories = [];
                this.isAdmin = false;
                this.currentUser = null;
                this.editor = null;
                this.currentEditingPage = null;

                // Get references to DOM elements
                this.sidebar = null;
                this.content = null;
                this.controls = null;
                this.editorModal = null;

                // Auth will be registered externally in initializeWiki()
            }

            async initialize() {
                // Get DOM references
                this.sidebar = document.querySelector('.wiki-sidebar');
                this.content = document.querySelector('.wiki-content');
                this.controls = document.querySelector('.wiki-controls');
                this.editorModal = document.querySelector('.wiki-editor');

                if (!this.sidebar || !this.content) {
                    console.error('Wiki container elements not found');
                    return;
                }

                await this.loadPages();
                this.setupEventListeners();
                this.renderSidebar();

                // Load welcome page by default
                const welcomePage = this.pages.find(p => p.slug === 'welcome');
                if (welcomePage) {
                    this.loadPage(welcomePage);
                } else if (this.pages.length > 0) {
                    this.loadPage(this.pages[0]);
                } else {
                    this.showEmptyState();
                }
            }

            async loadPages() {
                try {
                    // Load categories
                    const { data: categories, error: catError } = await supabase
                        .from('wiki_categories')
                        .select('*')
                        .order('position');

                    if (catError) throw catError;
                    this.categories = categories || [];

                    // Load pages
                    const { data: pages, error: pageError } = await supabase
                        .from('wiki_pages')
                        .select('*')
                        .eq('is_published', true)
                        .order('category, position');

                    if (pageError) throw pageError;
                    this.pages = pages || [];

                } catch (error) {
                    console.error('Error loading wiki pages:', error);
                    this.showError('Failed to load wiki pages');
                }
            }

            renderSidebar() {
                if (!this.sidebar) return;

                // Group pages by category
                const pagesByCategory = {};
                this.pages.forEach(page => {
                    const category = page.category || 'general';
                    if (!pagesByCategory[category]) {
                        pagesByCategory[category] = [];
                    }
                    pagesByCategory[category].push(page);
                });

                // Render sidebar
                let html = '';

                // Render categories with pages
                this.categories.forEach(category => {
                    const categoryPages = pagesByCategory[category.name] || [];
                    if (categoryPages.length > 0) {
                        html += `<div class="wiki-category">${category.name}</div>`;
                        categoryPages.forEach(page => {
                            const activeClass = this.currentPage && this.currentPage.id === page.id ? 'active' : '';
                            html += `<div class="wiki-nav-item ${activeClass}" data-page-id="${page.id}">${page.title}</div>`;
                        });
                    }
                });

                // Render uncategorized pages
                const uncategorized = pagesByCategory['general'] || [];
                const categoryNames = this.categories.map(c => c.name);
                Object.keys(pagesByCategory).forEach(categoryName => {
                    if (!categoryNames.includes(categoryName) && categoryName !== 'general') {
                        const categoryPages = pagesByCategory[categoryName];
                        if (categoryPages.length > 0) {
                            html += `<div class="wiki-category">${categoryName}</div>`;
                            categoryPages.forEach(page => {
                                const activeClass = this.currentPage && this.currentPage.id === page.id ? 'active' : '';
                                html += `<div class="wiki-nav-item ${activeClass}" data-page-id="${page.id}">${page.title}</div>`;
                            });
                        }
                    }
                });

                if (uncategorized.length > 0) {
                    html += `<div class="wiki-category">General</div>`;
                    uncategorized.forEach(page => {
                        const activeClass = this.currentPage && this.currentPage.id === page.id ? 'active' : '';
                        html += `<div class="wiki-nav-item ${activeClass}" data-page-id="${page.id}">${page.title}</div>`;
                    });
                }

                this.sidebar.innerHTML = html;
            }

            setupEventListeners() {
                // Sidebar navigation
                if (this.sidebar) {
                    this.sidebar.addEventListener('click', (e) => {
                        if (e.target.classList.contains('wiki-nav-item')) {
                            const pageId = e.target.dataset.pageId;
                            const page = this.pages.find(p => p.id === pageId);
                            if (page) {
                                this.loadPage(page);
                            }
                        }
                    });
                }

                // Control buttons
                if (this.controls) {
                    this.controls.addEventListener('click', (e) => {
                        if (e.target.matches('[data-action="new-page"]')) {
                            this.newPage();
                        } else if (e.target.matches('[data-action="edit-page"]')) {
                            this.editPage();
                        } else if (e.target.matches('[data-action="delete-page"]')) {
                            this.deletePage();
                        }
                    });
                }

                // Editor modal
                if (this.editorModal) {
                    // Close modal
                    this.editorModal.addEventListener('click', (e) => {
                        if (e.target === this.editorModal || e.target.matches('[data-action="close-editor"]')) {
                            this.closeEditor();
                        }
                    });

                    // Save button
                    this.editorModal.addEventListener('click', (e) => {
                        if (e.target.matches('[data-action="save-page"]')) {
                            this.savePage();
                        }
                    });

                    // Live preview
                    const textarea = this.editorModal.querySelector('.wiki-form-textarea');
                    if (textarea) {
                        textarea.addEventListener('input', () => {
                            this.updatePreview();
                        });
                    }

                    // Toolbar buttons
                    this.editorModal.addEventListener('click', (e) => {
                        if (e.target.classList.contains('wiki-toolbar-btn')) {
                            this.insertMarkdown(e.target.dataset.markdown);
                        }
                    });
                }
            }

            loadPage(page) {
                this.currentPage = page;

                // Update sidebar active state
                this.sidebar.querySelectorAll('.wiki-nav-item').forEach(item => {
                    item.classList.remove('active');
                    if (item.dataset.pageId === page.id) {
                        item.classList.add('active');
                    }
                });

                // Render page content
                this.renderPageContent(page);
                this.updateControls();
            }

            renderPageContent(page) {
                if (!this.content) return;

                try {
                    // Parse markdown and sanitize HTML
                    const html = marked.parse(page.content || '');
                    const sanitizedHtml = DOMPurify.sanitize(html);
                    this.content.innerHTML = sanitizedHtml;

                    // Highlight code blocks
                    this.content.querySelectorAll('pre code').forEach(block => {
                        hljs.highlightElement(block);
                    });
                } catch (error) {
                    console.error('Error rendering page content:', error);
                    this.content.innerHTML = '<p>Error loading page content.</p>';
                }
            }

            updateControls() {
                if (!this.controls) return;

                const canEdit = this.isAdmin;
                const hasCurrentPage = !!this.currentPage;

                let html = '';
                if (canEdit) {
                    html += `<button class="wiki-btn primary" data-action="new-page">âž• New Page</button>`;
                    if (hasCurrentPage) {
                        html += `<button class="wiki-btn secondary" data-action="edit-page">âœï¸ Edit</button>`;
                        html += `<button class="wiki-btn secondary" data-action="delete-page">ðŸ—‘ï¸ Delete</button>`;
                    }
                }

                this.controls.innerHTML = html;
            }

            newPage() {
                if (!this.isAdmin) return;

                this.currentEditingPage = {
                    id: null,
                    title: '',
                    slug: '',
                    content: '',
                    category: 'Getting Started'
                };

                this.showEditor();
            }

            editPage() {
                if (!this.isAdmin || !this.currentPage) return;

                this.currentEditingPage = { ...this.currentPage };
                this.showEditor();
            }

            async deletePage() {
                if (!this.isAdmin || !this.currentPage) return;

                if (!confirm(`Are you sure you want to delete "${this.currentPage.title}"?`)) {
                    return;
                }

                try {
                    const { error } = await supabase
                        .from('wiki_pages')
                        .delete()
                        .eq('id', this.currentPage.id);

                    if (error) throw error;

                    // Remove from local pages array
                    this.pages = this.pages.filter(p => p.id !== this.currentPage.id);

                    // Update UI
                    this.renderSidebar();

                    // Load another page or show empty state
                    if (this.pages.length > 0) {
                        this.loadPage(this.pages[0]);
                    } else {
                        this.showEmptyState();
                    }

                } catch (error) {
                    console.error('Error deleting page:', error);
                    alert('Failed to delete page');
                }
            }

            showEditor() {
                if (!this.editorModal || !this.currentEditingPage) return;

                // Populate form
                const titleInput = this.editorModal.querySelector('#wiki-title');
                const slugInput = this.editorModal.querySelector('#wiki-slug');
                const categorySelect = this.editorModal.querySelector('#wiki-category');
                const contentTextarea = this.editorModal.querySelector('#wiki-content');

                if (titleInput) titleInput.value = this.currentEditingPage.title;
                if (slugInput) slugInput.value = this.currentEditingPage.slug;
                if (categorySelect) {
                    categorySelect.value = this.currentEditingPage.category;
                    // Populate category options
                    let options = '';
                    this.categories.forEach(cat => {
                        options += `<option value="${cat.name}">${cat.name}</option>`;
                    });
                    categorySelect.innerHTML = options;
                }
                if (contentTextarea) contentTextarea.value = this.currentEditingPage.content;

                // Update preview
                this.updatePreview();

                // Show modal
                this.editorModal.classList.add('show');

                // Focus title input
                if (titleInput) titleInput.focus();
            }

            closeEditor() {
                if (this.editorModal) {
                    this.editorModal.classList.remove('show');
                }
                this.currentEditingPage = null;
            }

            async savePage() {
                if (!this.isAdmin || !this.currentEditingPage) return;

                const titleInput = this.editorModal.querySelector('#wiki-title');
                const slugInput = this.editorModal.querySelector('#wiki-slug');
                const categorySelect = this.editorModal.querySelector('#wiki-category');
                const contentTextarea = this.editorModal.querySelector('#wiki-content');

                const title = titleInput?.value.trim();
                const slug = slugInput?.value.trim() || this.generateSlug(title);
                const category = categorySelect?.value || 'Getting Started';
                const content = contentTextarea?.value || '';

                if (!title) {
                    alert('Please enter a title');
                    return;
                }

                try {
                    const pageData = {
                        title,
                        slug,
                        category,
                        content,
                        is_published: true
                    };

                    let savedPage;

                    if (this.currentEditingPage.id) {
                        // Update existing page
                        const { data, error } = await supabase
                            .from('wiki_pages')
                            .update(pageData)
                            .eq('id', this.currentEditingPage.id)
                            .select()
                            .single();

                        if (error) throw error;
                        savedPage = data;

                        // Update local pages array
                        const index = this.pages.findIndex(p => p.id === this.currentEditingPage.id);
                        if (index !== -1) {
                            this.pages[index] = savedPage;
                        }
                    } else {
                        // Create new page
                        const { data, error } = await supabase
                            .from('wiki_pages')
                            .insert(pageData)
                            .select()
                            .single();

                        if (error) throw error;
                        savedPage = data;

                        // Add to local pages array
                        this.pages.push(savedPage);
                    }

                    // Update UI
                    this.renderSidebar();
                    this.loadPage(savedPage);
                    this.closeEditor();

                } catch (error) {
                    console.error('Error saving page:', error);
                    alert('Failed to save page: ' + error.message);
                }
            }

            updatePreview() {
                const contentTextarea = this.editorModal.querySelector('#wiki-content');
                const preview = this.editorModal.querySelector('.wiki-editor-preview');

                if (!contentTextarea || !preview) return;

                try {
                    const html = marked.parse(contentTextarea.value || '');
                    const sanitizedHtml = DOMPurify.sanitize(html);
                    preview.innerHTML = sanitizedHtml;

                    // Highlight code blocks
                    preview.querySelectorAll('pre code').forEach(block => {
                        hljs.highlightElement(block);
                    });
                } catch (error) {
                    console.error('Error updating preview:', error);
                    preview.innerHTML = '<p>Error rendering preview</p>';
                }
            }

            insertMarkdown(markdown) {
                const textarea = this.editorModal.querySelector('#wiki-content');
                if (!textarea) return;

                const start = textarea.selectionStart;
                const end = textarea.selectionEnd;
                const text = textarea.value;
                const before = text.substring(0, start);
                const selected = text.substring(start, end);
                const after = text.substring(end);

                let replacement = markdown;
                if (markdown.includes('|text|')) {
                    replacement = markdown.replace('|text|', selected || 'text');
                } else if (selected) {
                    replacement = markdown + selected + markdown;
                }

                textarea.value = before + replacement + after;
                textarea.focus();

                // Update preview
                this.updatePreview();
            }

            generateSlug(title) {
                return title
                    .toLowerCase()
                    .replace(/[^a-z0-9]+/g, '-')
                    .replace(/^-+|-+$/g, '');
            }

            showEmptyState() {
                if (this.content) {
                    this.content.innerHTML = `
                        <div style="text-align: center; padding: 40px; color: var(--fg-dim);">
                            <h2>No wiki pages found</h2>
                            <p>Get started by creating your first page.</p>
                        </div>
                    `;
                }
                this.currentPage = null;
                this.updateControls();
            }

            showError(message) {
                if (this.content) {
                    this.content.innerHTML = `
                        <div style="text-align: center; padding: 40px; color: var(--warning);">
                            <h2>Error</h2>
                            <p>${message}</p>
                        </div>
                    `;
                }
            }
        }

        // YouTube Helper Functions
        function extractVideoId(url) {
            const regex = /(?:https?:\/\/)?(?:www\.)?(?:youtube\.com\/watch\?v=|youtu\.be\/)([a-zA-Z0-9_-]+)/;
            const match = url.match(regex);
            return match ? match[1] : null;
        }

        function formatDuration(duration) {
            // Convert ISO 8601 duration (PT4M13S) to readable format (4:13)
            const match = duration.match(/PT(?:(\d+)H)?(?:(\d+)M)?(?:(\d+)S)?/);
            const hours = parseInt(match[1]) || 0;
            const minutes = parseInt(match[2]) || 0;
            const seconds = parseInt(match[3]) || 0;

            if (hours > 0) {
                return `${hours}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            }
            return `${minutes}:${seconds.toString().padStart(2, '0')}`;
        }

        function formatViewCount(count) {
            const num = parseInt(count);
            if (num >= 1000000) {
                return (num / 1000000).toFixed(1) + 'M';
            } else if (num >= 1000) {
                return (num / 1000).toFixed(1) + 'K';
            }
            return num.toString();
        }

        function formatPublishDate(dateString) {
            const date = new Date(dateString);
            const now = new Date();
            const diffTime = Math.abs(now - date);
            const diffDays = Math.floor(diffTime / (1000 * 60 * 60 * 24));

            if (diffDays < 7) {
                return `${diffDays} day${diffDays !== 1 ? 's' : ''} ago`;
            } else if (diffDays < 30) {
                const weeks = Math.floor(diffDays / 7);
                return `${weeks} week${weeks !== 1 ? 's' : ''} ago`;
            } else if (diffDays < 365) {
                const months = Math.floor(diffDays / 30);
                return `${months} month${months !== 1 ? 's' : ''} ago`;
            } else {
                const years = Math.floor(diffDays / 365);
                return `${years} year${years !== 1 ? 's' : ''} ago`;
            }
        }

        async function fetchVideoMetadata(videoId) {
            try {
                const url = `${YOUTUBE_API_BASE}/videos?id=${videoId}&part=snippet,statistics,contentDetails&key=${YOUTUBE_API_KEY}`;
                const response = await fetch(url);

                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }

                const data = await response.json();

                if (!data.items || data.items.length === 0) {
                    throw new Error('Video not found');
                }

                const video = data.items[0];
                return {
                    id: videoId,
                    title: video.snippet.title,
                    description: video.snippet.description,
                    channelTitle: video.snippet.channelTitle,
                    publishedAt: video.snippet.publishedAt,
                    thumbnails: video.snippet.thumbnails,
                    duration: video.contentDetails.duration,
                    viewCount: video.statistics.viewCount,
                    likeCount: video.statistics.likeCount || '0'
                };
            } catch (error) {
                console.error('Error fetching video metadata:', error);
                return null;
            }
        }

        async function loadAllVideoMetadata() {
            const promises = videosConfig.map(async (videoConfig) => {
                const videoId = extractVideoId(videoConfig.url);
                if (!videoId) {
                    console.warn('Invalid YouTube URL:', videoConfig.url);
                    return null;
                }

                // Check cache first
                const cacheKey = `video_${videoId}`;
                const cached = sessionStorage.getItem(cacheKey);

                if (cached) {
                    const metadata = JSON.parse(cached);
                    videoMetadata.set(videoId, { ...metadata, config: videoConfig });
                    return metadata;
                }

                // Fetch from API
                const metadata = await fetchVideoMetadata(videoId);
                if (metadata) {
                    // Cache for this session
                    sessionStorage.setItem(cacheKey, JSON.stringify(metadata));
                    videoMetadata.set(videoId, { ...metadata, config: videoConfig });
                }

                return metadata;
            });

            const results = await Promise.all(promises);
            return results.filter(result => result !== null);
        }

        // Video Management Class
        class VideoManager {
            constructor() {
                this.videosGrid = document.getElementById('videos-grid');
                this.loadedPlayers = new Set();
            }

            async initialize() {
                await loadAllVideoMetadata();
                this.renderVideos();
            }

            renderVideos() {
                // Clear existing content
                this.videosGrid.innerHTML = '';

                videoMetadata.forEach((video, videoId) => {
                    const videoCard = this.createVideoCard(video);
                    this.videosGrid.appendChild(videoCard);
                });

                // Re-setup filters after videos are loaded
                setupVideoFilters();
            }

            createVideoCard(video) {
                const card = document.createElement('div');
                card.className = 'video-card';
                card.dataset.tags = video.config.tags.join(',');

                const thumbnail = video.thumbnails.maxres || video.thumbnails.high || video.thumbnails.medium;
                const customDesc = video.config.customDescription || video.description;

                card.innerHTML = `
                    <div class="video-embed-container">
                        <img src="${thumbnail.url}" alt="${this.escapeHtml(video.title)}" class="video-thumbnail">
                        <div class="video-overlay" onclick="videoManager.loadVideo('${video.id}')">
                            <button class="play-button" aria-label="Play video"></button>
                        </div>
                        <div class="video-duration">${formatDuration(video.duration)}</div>
                    </div>
                    <div class="video-info">
                        <h3 class="video-title">${this.escapeHtml(video.title)}</h3>
                        <div class="video-channel">${this.escapeHtml(video.channelTitle)}</div>
                        <div class="video-tags">
                            ${video.config.tags.map(tag => `<span class="video-tag">${tag}</span>`).join('')}
                        </div>
                        <p class="video-description">${this.escapeHtml(customDesc)}</p>
                        <div class="video-meta">
                            <span>ðŸ‘ ${formatViewCount(video.viewCount)} views</span>
                            <span>ðŸ“… ${formatPublishDate(video.publishedAt)}</span>
                            <span>â± ${formatDuration(video.duration)}</span>
                        </div>
                    </div>
                `;

                return card;
            }

            loadVideo(videoId) {
                if (this.loadedPlayers.has(videoId)) return;

                // Find the container for this video
                const container = document.querySelector(`[onclick="videoManager.loadVideo('${videoId}')"]`);
                if (!container) return;

                // Replace thumbnail with iframe
                container.innerHTML = `
                    <iframe
                        class="video-player"
                        src="https://www.youtube.com/embed/${videoId}?autoplay=1&rel=0"
                        frameborder="0"
                        allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
                        allowfullscreen>
                    </iframe>
                `;

                this.loadedPlayers.add(videoId);
            }

            escapeHtml(text) {
                const div = document.createElement('div');
                div.textContent = text;
                return div.innerHTML;
            }
        }

        // Initialize video manager
        let videoManager = null;

        function initializeVideos() {
            if (!videoManager) {
                videoManager = new VideoManager();
                videoManager.initialize();
            }
        }

        // Setup video filtering
        function setupVideoFilters() {
            const videoFilters = document.getElementById('video-filters');
            if (!videoFilters) return;

            const buttons = videoFilters.querySelectorAll('.category-btn');
            const videosGrid = document.getElementById('videos-grid');
            const videoCards = videosGrid.querySelectorAll('.video-card');

            buttons.forEach(btn => {
                // Remove existing listeners to avoid duplicates
                btn.replaceWith(btn.cloneNode(true));
            });

            // Re-get buttons after cloning to get fresh event listeners
            const freshButtons = videoFilters.querySelectorAll('.category-btn');

            freshButtons.forEach(btn => {
                btn.addEventListener('click', () => {
                    const category = btn.dataset.category;

                    freshButtons.forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');

                    // Re-query video cards each time (they might have changed)
                    const currentVideoCards = videosGrid.querySelectorAll('.video-card');

                    currentVideoCards.forEach(item => {
                        if (category === 'all') {
                            item.style.display = 'block';
                        } else {
                            const itemTags = item.dataset.tags ? item.dataset.tags.toLowerCase().split(',') : [];
                            if (itemTags.includes(category)) {
                                item.style.display = 'block';
                            } else {
                                item.style.display = 'none';
                            }
                        }
                    });
                });
            });
        }

        // Kanban functionality
        class KanbanBoard {
            constructor() {
                this.initializeElements();
                this.bindEvents();
                this.setupAuthListener();
                this.loadTasks();
            }

            initializeElements() {
                this.addTaskBtn = document.getElementById('add-task-btn');
                this.taskModal = document.getElementById('task-modal');
                this.taskForm = document.getElementById('task-form');

                this.columns = {
                    todo: document.getElementById('todo-tasks'),
                    inprogress: document.getElementById('inprogress-tasks'),
                    done: document.getElementById('done-tasks')
                };

                this.counts = {
                    todo: document.getElementById('todo-count'),
                    inprogress: document.getElementById('inprogress-count'),
                    done: document.getElementById('done-count')
                };
            }

            bindEvents() {
                // Task events
                this.addTaskBtn.addEventListener('click', () => this.openTaskModal());
                document.getElementById('modal-close').addEventListener('click', () => this.closeTaskModal());
                document.getElementById('cancel-btn').addEventListener('click', () => this.closeTaskModal());
                this.taskForm.addEventListener('submit', (e) => this.handleTaskSubmit(e));
                document.getElementById('delete-btn').addEventListener('click', () => this.deleteTask());

                // Drag and drop events
                this.setupDragAndDrop();

                // Close modals on outside click
                window.addEventListener('click', (e) => {
                    if (e.target === this.taskModal) this.closeTaskModal();
                });
            }

            setupAuthListener() {
                // Listen for auth changes from global auth
                if (globalAuth) {
                    globalAuth.onAuthChange((isAdmin, user) => {
                        this.updateTasksUI(isAdmin);
                    });
                } else {
                    // Fallback for initial load - wait for globalAuth to be ready
                    const checkGlobalAuth = () => {
                        if (globalAuth) {
                            globalAuth.onAuthChange((isAdmin, user) => {
                                this.updateTasksUI(isAdmin);
                            });
                            this.updateTasksUI(globalAuth.admin);
                        } else {
                            setTimeout(checkGlobalAuth, 100);
                        }
                    };
                    checkGlobalAuth();
                }
            }

            updateTasksUI(isAdmin) {
                this.addTaskBtn.disabled = !isAdmin;

                // Re-render tasks to update edit buttons
                this.renderTasks();
            }


            async loadTasks() {
                try {
                    const { data, error } = await supabase
                        .from('tasks')
                        .select('*')
                        .eq('is_public', true)
                        .order('position');

                    if (error) throw error;

                    tasks = data || [];
                    this.renderTasks();
                } catch (error) {
                    console.error('Error loading tasks:', error);
                }
            }

            renderTasks() {
                // Clear columns
                Object.values(this.columns).forEach(column => {
                    column.innerHTML = '';
                });

                // Group tasks by status
                const tasksByStatus = {
                    todo: tasks.filter(t => t.status === 'todo'),
                    inprogress: tasks.filter(t => t.status === 'inprogress'),
                    done: tasks.filter(t => t.status === 'done')
                };

                // Render tasks in each column
                Object.entries(tasksByStatus).forEach(([status, statusTasks]) => {
                    statusTasks.forEach(task => {
                        this.columns[status].appendChild(this.createTaskElement(task));
                    });
                });

                // Update counts
                Object.entries(tasksByStatus).forEach(([status, statusTasks]) => {
                    this.counts[status].textContent = statusTasks.length;
                });
            }

            createTaskElement(task) {
                const taskEl = document.createElement('div');
                const currentAdmin = globalAuth ? globalAuth.admin : false;
                taskEl.className = `task-card priority-${task.priority}`;
                taskEl.draggable = currentAdmin;
                taskEl.dataset.taskId = task.id;

                const actionsHtml = currentAdmin ? `
                    <div class="task-actions">
                        <button class="task-action" onclick="kanban.editTask('${task.id}')" title="Edit">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M20.71,7.04C21.1,6.65 21.1,6 20.71,5.63L18.37,3.29C18,2.9 17.35,2.9 16.96,3.29L15.12,5.12L18.87,8.87M3,17.25V21H6.75L17.81,9.93L14.06,6.18L3,17.25Z"/>
                            </svg>
                        </button>
                    </div>
                ` : '';

                taskEl.innerHTML = `
                    <div class="task-header">
                        <h4 class="task-title">${this.escapeHtml(task.title)}</h4>
                        ${actionsHtml}
                    </div>
                    ${task.description ? `<p class="task-description">${this.escapeHtml(task.description)}</p>` : ''}
                    <div class="task-priority ${task.priority}">${task.priority}</div>
                `;

                if (currentAdmin) {
                    this.addDragListeners(taskEl);
                }

                return taskEl;
            }

            escapeHtml(text) {
                const div = document.createElement('div');
                div.textContent = text;
                return div.innerHTML;
            }

            setupDragAndDrop() {
                Object.entries(this.columns).forEach(([status, column]) => {
                    column.addEventListener('dragover', (e) => {
                        const currentAdmin = globalAuth ? globalAuth.admin : false;
                        if (!currentAdmin) return;
                        e.preventDefault();
                        column.classList.add('drag-over');
                    });

                    column.addEventListener('dragleave', (e) => {
                        const currentAdmin = globalAuth ? globalAuth.admin : false;
                        if (!currentAdmin) return;
                        if (!column.contains(e.relatedTarget)) {
                            column.classList.remove('drag-over');
                        }
                    });

                    column.addEventListener('drop', (e) => {
                        const currentAdmin = globalAuth ? globalAuth.admin : false;
                        if (!currentAdmin) return;
                        e.preventDefault();
                        column.classList.remove('drag-over');

                        const taskId = e.dataTransfer.getData('text/plain');
                        this.moveTask(taskId, status);
                    });
                });
            }

            addDragListeners(taskEl) {
                taskEl.addEventListener('dragstart', (e) => {
                    const currentAdmin = globalAuth ? globalAuth.admin : false;
                    if (!currentAdmin) return;
                    e.dataTransfer.setData('text/plain', taskEl.dataset.taskId);
                    taskEl.classList.add('dragging');
                });

                taskEl.addEventListener('dragend', (e) => {
                    taskEl.classList.remove('dragging');
                });
            }

            async moveTask(taskId, newStatus) {
                try {
                    const task = tasks.find(t => t.id === taskId);
                    if (!task || task.status === newStatus) return;

                    // Update in database
                    const { error } = await supabase
                        .from('tasks')
                        .update({ status: newStatus })
                        .eq('id', taskId);

                    if (error) throw error;

                    // Update local state
                    task.status = newStatus;
                    this.renderTasks();

                } catch (error) {
                    console.error('Error moving task:', error);
                }
            }

            openTaskModal(taskId = null) {
                currentEditingTask = taskId;
                const isEditing = !!taskId;

                document.getElementById('modal-title').textContent = isEditing ? 'Edit Task' : 'Add Task';
                document.getElementById('delete-btn').style.display = isEditing ? 'block' : 'none';

                if (isEditing) {
                    const task = tasks.find(t => t.id === taskId);
                    if (task) {
                        document.getElementById('task-title').value = task.title;
                        document.getElementById('task-description').value = task.description || '';
                        document.getElementById('task-priority').value = task.priority;
                    }
                } else {
                    this.taskForm.reset();
                }

                this.taskModal.classList.add('show');
                document.getElementById('task-title').focus();
            }

            closeTaskModal() {
                this.taskModal.classList.remove('show');
                this.taskForm.reset();
                currentEditingTask = null;
            }

            async handleTaskSubmit(e) {
                e.preventDefault();

                const title = document.getElementById('task-title').value.trim();
                const description = document.getElementById('task-description').value.trim();
                const priority = document.getElementById('task-priority').value;

                if (!title) return;

                try {
                    if (currentEditingTask) {
                        // Update existing task
                        const { error } = await supabase
                            .from('tasks')
                            .update({ title, description, priority })
                            .eq('id', currentEditingTask);

                        if (error) throw error;

                        // Update local state
                        const task = tasks.find(t => t.id === currentEditingTask);
                        if (task) {
                            task.title = title;
                            task.description = description;
                            task.priority = priority;
                        }
                    } else {
                        // Create new task
                        const newTask = {
                            title,
                            description,
                            priority,
                            status: 'todo',
                            position: tasks.length,
                            is_public: true
                        };

                        const { data, error } = await supabase
                            .from('tasks')
                            .insert([newTask])
                            .select()
                            .single();

                        if (error) throw error;

                        tasks.push(data);
                    }

                    this.renderTasks();
                    this.closeTaskModal();

                } catch (error) {
                    console.error('Error saving task:', error);
                    alert('Error saving task. Please try again.');
                }
            }

            async deleteTask() {
                if (!currentEditingTask || !confirm('Are you sure you want to delete this task?')) return;

                try {
                    const { error } = await supabase
                        .from('tasks')
                        .delete()
                        .eq('id', currentEditingTask);

                    if (error) throw error;

                    // Remove from local state
                    tasks = tasks.filter(t => t.id !== currentEditingTask);
                    this.renderTasks();
                    this.closeTaskModal();

                } catch (error) {
                    console.error('Error deleting task:', error);
                    alert('Error deleting task. Please try again.');
                }
            }

            editTask(taskId) {
                this.openTaskModal(taskId);
            }
        }

        // Initialize Kanban when Tasks section is shown
        let kanban = null;

        function initializeKanban() {
            if (!kanban) {
                kanban = new KanbanBoard();
            }
        }

        // Initialize Wiki when Wiki section is shown
        function initializeWiki() {
            if (!wikiManager) {
                wikiManager = new WikiManager();

                // Register with global auth after creation
                if (globalAuth) {
                    globalAuth.registerCallback((isAdmin, user) => {
                        wikiManager.isAdmin = isAdmin;
                        wikiManager.currentUser = user;
                        wikiManager.updateControls();
                    });

                    // Set initial auth state
                    wikiManager.isAdmin = globalAuth.admin;
                    wikiManager.currentUser = globalAuth.user;
                }

                wikiManager.initialize();
            }
        }

        // Theme management
        function toggleTheme() {
            document.body.classList.toggle('light-mode');
            const isLight = document.body.classList.contains('light-mode');
            localStorage.setItem('theme', isLight ? 'light' : 'dark');
            updateThemeIcon(isLight);
        }

        function updateThemeIcon(isLight) {
            const icon = document.getElementById('theme-icon');
            if (isLight) {
                // Moon icon (for light mode - click to go dark)
                icon.innerHTML = '<path d="M17.75,4.09L15.22,6.03L16.13,9.09L13.5,7.28L10.87,9.09L11.78,6.03L9.25,4.09L12.44,4L13.5,1L14.56,4L17.75,4.09M21.25,11L19.61,12.25L20.2,14.23L18.5,13.06L16.8,14.23L17.39,12.25L15.75,11L17.81,10.95L18.5,9L19.19,10.95L21.25,11M18.97,15.95C19.8,15.87 20.69,17.05 20.16,17.8C19.84,18.25 19.5,18.67 19.08,19.07C15.17,23 8.84,23 4.94,19.07C1.03,15.17 1.03,8.83 4.94,4.93C5.34,4.53 5.76,4.17 6.21,3.85C6.96,3.32 8.14,4.21 8.06,5.04C7.79,7.9 8.75,10.87 10.95,13.06C13.14,15.26 16.1,16.22 18.97,15.95M17.33,17.97C14.5,17.81 11.7,16.64 9.53,14.5C7.36,12.31 6.2,9.5 6.04,6.68C3.23,9.82 3.34,14.64 6.35,17.66C9.37,20.67 14.19,20.78 17.33,17.97Z"/>';
            } else {
                // Sun icon (for dark mode - click to go light)
                icon.innerHTML = '<path d="M12,7A5,5 0 0,1 17,12A5,5 0 0,1 12,17A5,5 0 0,1 7,12A5,5 0 0,1 12,7M12,9A3,3 0 0,0 9,12A3,3 0 0,0 12,15A3,3 0 0,0 15,12A3,3 0 0,0 12,9M12,2L14.39,5.42C13.65,5.15 12.84,5 12,5C11.16,5 10.35,5.15 9.61,5.42L12,2M3.34,7L7.5,6.65C6.9,7.16 6.36,7.78 5.94,8.5C5.5,9.24 5.25,10 5.11,10.79L3.34,7M3.36,17L5.12,13.23C5.26,14 5.53,14.78 5.95,15.5C6.37,16.24 6.91,16.86 7.5,17.37L3.36,17M20.65,7L18.88,10.79C18.74,10 18.47,9.23 18.05,8.5C17.63,7.78 17.1,7.15 16.5,6.64L20.65,7M20.64,17L16.5,17.36C17.09,16.85 17.62,16.22 18.04,15.5C18.46,14.77 18.73,14 18.87,13.21L20.64,17Z"/>';
            }
        }

        // Load theme preference
        const savedTheme = localStorage.getItem('theme');
        if (savedTheme === 'light') {
            document.body.classList.add('light-mode');
            updateThemeIcon(true);
        }

        // Navigation
        const navItems = document.querySelectorAll('.nav-item');
        const sections = document.querySelectorAll('.section');

        navItems.forEach(item => {
            item.addEventListener('click', (e) => {
                e.preventDefault();
                const targetSection = item.dataset.section;
                
                navItems.forEach(nav => nav.classList.remove('active'));
                item.classList.add('active');
                
                sections.forEach(section => {
                    section.classList.remove('active');
                    if (section.id === targetSection) {
                        section.classList.add('active');
                        // Initialize sections when shown
                        if (targetSection === 'tasks') {
                            initializeKanban();
                        } else if (targetSection === 'videos') {
                            initializeVideos();
                        } else if (targetSection === 'wiki') {
                            initializeWiki();
                        }
                    }
                });
            });
        });

        // Category filtering
        document.querySelectorAll('.category-filters').forEach(filterGroup => {
            const buttons = filterGroup.querySelectorAll('.category-btn');
            const section = filterGroup.closest('.section');
            const items = section.querySelectorAll('.item-card, .video-card');

            buttons.forEach(btn => {
                btn.addEventListener('click', () => {
                    const category = btn.dataset.category;
                    
                    buttons.forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                    
                    items.forEach(item => {
                        if (category === 'all') {
                            item.style.display = 'block';
                        } else {
                            const itemTags = item.dataset.tags ? item.dataset.tags.toLowerCase().split(',') : [];
                            if (itemTags.includes(category)) {
                                item.style.display = 'block';
                            } else {
                                item.style.display = 'none';
                            }
                        }
                    });
                });
            });
        });
    </script>
</body>
</html>
